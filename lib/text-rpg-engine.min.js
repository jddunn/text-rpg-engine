!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("text-rpg-engine",[],t):"object"==typeof exports?exports["text-rpg-engine"]=t():e["text-rpg-engine"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new(((o=n(1))&&o.__esModule?o:{default:o}).default);t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(2)),r=u(n(3)),i=u(n(4)),a=u(n(6));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Display=new o.default,this.Input=new r.default,this.datapath=t,this.rooms=n,this.startRoom=a,this.endRoom=u,this.Player=new i.default(this.startRoom)}var t,n,u;return t=e,(n=[{key:"init",value:function(){var e;""!==this.dataPath&&console.log("Initialized game from: "+this.datapath),""===this.startRoom&&this.rooms.length>0&&(this.startRoom=this.rooms[0].name,this.Player.startRoom=this.startRoom,this.Player.currentRoom=this.Player.startRoom),""===this.endRoom&&this.rooms.length>1&&(this.endRoom=this.rooms[this.rooms.length-1].name);for(var t=0;t<this.rooms.length;t++)if(this.rooms[t].name===this.startRoom){e=this.rooms[t].getText;break}void 0===e&&(e="No starting room text found!"),this.Display.show(e)}},{key:"addRoom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=new a.default(e,t,n,o);return this.rooms.push(r),r}},{key:"dropRoom",value:function(e){var t=this.rooms.filter(function(t){return t.name!==e});return this.rooms=t,this.rooms}},{key:"getRoom",value:function(e){return this.rooms.find(function(t){return t.name===e})}},{key:"userSend",value:function(e){this.Input.send(e),this.decidePath(this.Input.value)}},{key:"decidePath",value:function(e){var t=this,n=t.getRoom(t.Player.currentRoom);void 0!==s(n.prompts)?n.prompts.forEach(function(n){var o=n.matchKeywords(e);null!==o?(console.log("FOUND MATCHING PROMPT RESULTS: ",o),t.Display.show(o.text),void 0!==o.resultItems&&Array.prototype.push.apply(t.Player.inventory.items,o.items),void 0!==o.resultRoom&&(t.Player.currentRoom=o.room,o.Room===t.endRoom?t.win():o.Room.enter(t.Player.inventory.items))):t.Display.show('<p>No actions could be done from: "'.concat(e,'". Try something else.</p>\n                              ').concat(t.getRoom(t.Player.currentRoom).getText,"\n          "))}):t.Display.show("<p>There doesn't seem to be any actions at all that you can do in this room.</p>\n                        ".concat(t.getRoom(t.Player.currentRoom).getText,"\n      "))}},{key:"disableInput",value:function(){this.Input.disable()}},{key:"enableInput",value:function(){this.Input.enable()}},{key:"win",value:function(){for(var e=0;e<this.rooms.length;e++)this.rooms[e].name===this.endRoom&&this.Display.show(this.rooms[e].getText);this.disableInput()}},{key:"resetPlayer",value:function(){}}])&&l(t.prototype,n),u&&l(t,u),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"display";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.html=t,this.elementId=n}var t,n,r;return t=e,(n=[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e?document.getElementById(this.elementId).innerHTML=this.html:(document.getElementById(this.elementId).innerHTML=e,this.html=e)}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"input";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.disabled=t,this.value=n,this.elementId=o}var t,n,r;return t=e,(n=[{key:"enable",value:function(){this.disabled=!1,document.getElementById("input").disabled=!1}},{key:"disable",value:function(){this.disabled=!0,document.getElementById("input").disabled=!0}},{key:"send",value:function(e){e=e.toLowerCase(),this.value=e}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(5))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"player",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.default,o=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments[3]);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.inventory=n,this.startRoom=o,""===this.currentRoom&&(this.currentRoom=this.startRoom)}var t,n,o;return t=e,(n=[{key:"enterRoom",value:function(e){var t=e.enter(this.inventory.items);return!1===t[1]||(this.currentRoom=e.name),[t[0],t[1]]}},{key:"getItem",value:function(e){return this.inventory.addItem(e),this.inventory}},{key:"dropItem",value:function(e){return this.inventory.dropItem(e),this.inventory}},{key:"doAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t?this.currentRoom.doAction(e):t.doAction(e)}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=t}var t,n,r;return t=e,(n=[{key:"examine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==e?this.items[e].getText:this.items.map(function(e){return e.name})}},{key:"getItemProps",value:function(e){return this.items[e]}},{key:"addItem",value:function(e){return this.items.push(e),this.items}},{key:"dropItem",value:function(e){var t=this.items.filter(function(t){return t.name!==e});return this.items=t,this.items}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(7))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.getText=n,this.prompts=o,this.requirements=r}var t,n,o;return t=e,(n=[{key:"addPrompt",value:function(e,t,n){var o=new r.default(e,t,n);return this.prompts.push(o),this.prompts}},{key:"enter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="",n=!0;return this.requirements>0?0===e.length?(n=!1,this.requirements.forEach(function(e){t+="".concat(e.failText,". ")})):(this.requirements.forEach(function(e){var o=!1;this.items.forEach(function(t){t===e&&(o=!0)}),!1===o&&(n=!1,t+=e.failText)}),!0===n&&(t=this.getText)):t=this.getText,[t,n]}},{key:"doAction",value:function(e){var t={};return 0===this.prompts.length&&(t.text="There doesn't seem to be any actions you can do in this room."),Object.values(this.prompts).forEach(function(n,o){e===n&&(t.text=o.resultText,null!==o.resultItems&&(t.items=o.resultItems),null!==o.resultRoom&&(t.result=o.resultRoom))}),t}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.keywords=n.map(function(e){return e.toLowerCase()}),this.results=o}var t,n,r;return t=e,(n=[{key:"matchKeywords",value:function(e){var t=!1;return this.keywords.forEach(function(n){e.includes(n.toLowerCase())&&(t=!0)}),t?this.results:null}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL3RleHQtcnBnLWVuZ2luZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdGV4dC1ycGctZW5naW5lLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vdGV4dC1ycGctZW5naW5lLy4vc3JjL2Rpc3BsYXkuanMiLCJ3ZWJwYWNrOi8vdGV4dC1ycGctZW5naW5lLy4vc3JjL2lucHV0LmpzIiwid2VicGFjazovL3RleHQtcnBnLWVuZ2luZS8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vdGV4dC1ycGctZW5naW5lLy4vc3JjL2ludmVudG9yeS5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvcm9vbS5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvcHJvbXB0LmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInNlbGYiLCJ0aGlzIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImRlZmF1bHQiLCJfZGlzcGxheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfaW5wdXQiLCJfcGxheWVyIiwiX3Jvb20iLCJHYW1lIiwiZGF0YXBhdGgiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyb29tcyIsInN0YXJ0Um9vbSIsImVuZFJvb20iLCJfY2xhc3NDYWxsQ2hlY2siLCJEaXNwbGF5IiwiSW5wdXQiLCJQbGF5ZXIiLCJkaXNwbGF5VGV4dCIsImRhdGFQYXRoIiwiY29uc29sZSIsImxvZyIsImN1cnJlbnRSb29tIiwiZ2V0VGV4dCIsInNob3ciLCJwcm9tcHRzIiwicmVxdWlyZW1lbnRzIiwicm9vbU9iaiIsInB1c2giLCJyb29tTmFtZSIsIm5ld1Jvb21zIiwiZmlsdGVyIiwicm9vbSIsImZpbmQiLCJ4IiwibWVzc2FnZSIsInNlbmQiLCJkZWNpZGVQYXRoIiwiX3RoaXMiLCJjdXJyUm9vbSIsImdldFJvb20iLCJfdHlwZW9mIiwiZm9yRWFjaCIsInByb21wdCIsIm1hdGNoaW5nUHJvbXB0UmVzdWx0cyIsIm1hdGNoS2V5d29yZHMiLCJ0ZXh0IiwicmVzdWx0SXRlbXMiLCJBcnJheSIsImFwcGx5IiwiaW52ZW50b3J5IiwiaXRlbXMiLCJyZXN1bHRSb29tIiwiUm9vbSIsIndpbiIsImVudGVyIiwiY29uY2F0IiwiZGlzYWJsZSIsImVuYWJsZSIsImRpc2FibGVJbnB1dCIsImh0bWwiLCJlbGVtZW50SWQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwiZGlzYWJsZWQiLCJ0b0xvd2VyQ2FzZSIsIl9pbnZlbnRvcnkiLCJyZXMiLCJpdGVtIiwiYWRkSXRlbSIsImRyb3BJdGVtIiwiZG9BY3Rpb24iLCJJbnZlbnRvcnkiLCJpdGVtTmFtZSIsIm1hcCIsImEiLCJuZXdJbnZlbnRvcnkiLCJfcHJvbXB0Iiwia2V5d29yZHMiLCJyZXN1bHRzIiwicmVzdWx0IiwibWV0QWxsUmVxdWlyZW1lbnRzIiwicmVxdWlyZW1lbnQiLCJmYWlsVGV4dCIsImZvdW5kIiwidmFsdWVzIiwidmFsIiwicmVzdWx0VGV4dCIsIlByb21w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QUE2QnZFLFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQWxCLEdBQUl3RSxFQUFjeEUsVUFBQUMsT0FBQSxRQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBSixnR0FBSU0sQ0FBQWxELEtBQUE2SCxHQUNsRDdILEtBQUtXLEtBQU9BLEVBRVpYLEtBQUttSCxTQUFXQSxFQUFTSixJQUFJLFNBQVNlLEdBQUssT0FBT0EsRUFBRXhCLGdCQUlwRHRHLEtBQUtvSCxRQUFVQSwrREFJSDdDLEdBQ1osSUFBSWtELEdBQVEsRUFNWixPQUxBekgsS0FBS21ILFNBQVNyQyxRQUFRLFNBQVNpRCxHQUN6QnhELEVBQVF5RCxTQUFTRCxFQUFRekIsaUJBQzNCbUIsR0FBUSxLQUdSQSxFQUNLekgsS0FBS29ILFFBRVAiLCJmaWxlIjoidGV4dC1ycGctZW5naW5lLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwidGV4dC1ycGctZW5naW5lXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInRleHQtcnBnLWVuZ2luZVwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJ0ZXh0LXJwZy1lbmdpbmVcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJztcclxuXHJcbmNvbnN0IGdhbWUgPSBuZXcgR2FtZSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZ2FtZTtcclxuIiwiaW1wb3J0IERpc3BsYXkgZnJvbSAnLi9kaXNwbGF5JztcclxuaW1wb3J0IElucHV0IGZyb20gJy4vaW5wdXQnO1xyXG5pbXBvcnQgUGxheWVyIGZyb20gJy4vcGxheWVyJztcclxuaW1wb3J0IFJvb20gZnJvbSAnLi9yb29tJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWUge1xyXG5cclxuICBjb25zdHJ1Y3RvcihkYXRhcGF0aCA9ICcnLCByb29tcyA9IFtdLCBzdGFydFJvb20gPSAnJywgZW5kUm9vbSA9ICcnKSB7XHJcbiAgICB0aGlzLkRpc3BsYXkgPSBuZXcgRGlzcGxheSgpO1xyXG4gICAgdGhpcy5JbnB1dCA9IG5ldyBJbnB1dCgpO1xyXG4gICAgdGhpcy5kYXRhcGF0aCA9IGRhdGFwYXRoOyAvLyBUT0RPOiBCZSBhYmxlIHRvIGhhdmUgZ2FtZSBpbml0aWFsaXplIGRhdGEgZnJvbSBKU09OIGZpbGVcclxuICAgIHRoaXMucm9vbXMgPSByb29tczsgLy8gQWxsIHRoZSByb29tcyBpbnNpZGUgb3VyIGdhbWVcclxuICAgIHRoaXMuc3RhcnRSb29tID0gc3RhcnRSb29tOyAvLyBXaGljaCByb29tIHdpbGwgdGhlIHBsYXllciBzdGFydCBpblxyXG4gICAgdGhpcy5lbmRSb29tID0gZW5kUm9vbTsgLy8gV2hpY2ggcm9vbSBcclxuICAgIHRoaXMuUGxheWVyID0gbmV3IFBsYXllcih0aGlzLnN0YXJ0Um9vbSk7IC8vIFRPRE86IEFsbG93IHBsYXllcnMgdG8gZ2l2ZSB0aGVpciBjaGFyYWN0ZXJzIHRoZWlyIG93biBuYW1lcyBsYXRlclxyXG4gIH1cclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIGxldCBkaXNwbGF5VGV4dDtcclxuICAgIGlmICh0aGlzLmRhdGFQYXRoICE9PSAnJykge1xyXG4gICAgICAvLyB0aGlzLmxvYWREYXRhKHRoaXMuZGF0YVBhdGgpO1xyXG4gICAgICBjb25zb2xlLmxvZygnSW5pdGlhbGl6ZWQgZ2FtZSBmcm9tOiAnICsgdGhpcy5kYXRhcGF0aCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5zdGFydFJvb20gPT09ICcnICYmIHRoaXMucm9vbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLnN0YXJ0Um9vbSA9IHRoaXMucm9vbXNbMF0ubmFtZTsgXHJcbiAgICAgIHRoaXMuUGxheWVyLnN0YXJ0Um9vbSA9IHRoaXMuc3RhcnRSb29tO1xyXG4gICAgICB0aGlzLlBsYXllci5jdXJyZW50Um9vbSA9IHRoaXMuUGxheWVyLnN0YXJ0Um9vbTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmVuZFJvb20gPT09ICcnICYmIHRoaXMucm9vbXMubGVuZ3RoID4gMSkge1xyXG4gICAgICB0aGlzLmVuZFJvb20gPSB0aGlzLnJvb21zW3RoaXMucm9vbXMubGVuZ3RoIC0gMV0ubmFtZTsgICAgICBcclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5yb29tcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAodGhpcy5yb29tc1tpXS5uYW1lID09PSB0aGlzLnN0YXJ0Um9vbSkge1xyXG4gICAgICAgIGRpc3BsYXlUZXh0ID0gdGhpcy5yb29tc1tpXS5nZXRUZXh0O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZGlzcGxheVRleHQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBkaXNwbGF5VGV4dCA9ICdObyBzdGFydGluZyByb29tIHRleHQgZm91bmQhJztcclxuICAgIH1cclxuICAgIHRoaXMuRGlzcGxheS5zaG93KGRpc3BsYXlUZXh0KTtcclxuICB9XHJcblxyXG4gIGFkZFJvb20obmFtZSwgZ2V0VGV4dCwgcHJvbXB0cyA9IFtdLCByZXF1aXJlbWVudHMgPSBbXSkge1xyXG4gICAgbGV0IHJvb21PYmogPSBuZXcgUm9vbShuYW1lLCBnZXRUZXh0LCBwcm9tcHRzLCByZXF1aXJlbWVudHMpO1xyXG4gICAgdGhpcy5yb29tcy5wdXNoKHJvb21PYmopO1xyXG4gICAgcmV0dXJuIHJvb21PYmo7XHJcbiAgfVxyXG5cclxuICBkcm9wUm9vbShyb29tTmFtZSkge1xyXG4gICAgbGV0IG5ld1Jvb21zID0gdGhpcy5yb29tcy5maWx0ZXIoZnVuY3Rpb24ocm9vbSkge1xyXG4gICAgICByZXR1cm4gcm9vbS5uYW1lICE9PSByb29tTmFtZTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5yb29tcyA9IG5ld1Jvb21zO1xyXG4gICAgcmV0dXJuIHRoaXMucm9vbXM7XHJcbiAgfVxyXG5cclxuICBnZXRSb29tKHJvb21OYW1lKSB7XHJcbiAgICBjb25zdCByb29tID0gdGhpcy5yb29tcy5maW5kKHggPT4geC5uYW1lID09PSByb29tTmFtZSk7XHJcbiAgICByZXR1cm4gcm9vbTtcclxuICB9XHJcblxyXG4gIHVzZXJTZW5kKG1lc3NhZ2UpIHtcclxuICAgIC8vIE91ciBJbnB1dCBjbGFzcyB3aWxsIGhhbmRsZSBjbGVhbmluZyAvIG5vcm1hbGl6aW5nIHN0cmluZ3NcclxuICAgIHRoaXMuSW5wdXQuc2VuZChtZXNzYWdlKTtcclxuICAgIHRoaXMuZGVjaWRlUGF0aCh0aGlzLklucHV0LnZhbHVlKTtcclxuICB9XHJcblxyXG4gIGRlY2lkZVBhdGgobWVzc2FnZSkge1xyXG4gICAgLy8gQ2hlY2sgdG8gc2VlIGlmIGFuIGl0ZW0gbmFtZSB3YXMgaW4gdGhlIG1lc3NhZ2VcclxuICAgIC8vIGlmIChtZXNzYWdlLnNwbGl0KCkpXHJcbiAgICBjb25zdCBfdGhpcyA9IHRoaXM7XHJcbiAgICBjb25zdCBjdXJyUm9vbSA9IF90aGlzLmdldFJvb20oX3RoaXMuUGxheWVyLmN1cnJlbnRSb29tKTtcclxuICAgIGlmICh0eXBlb2YgY3VyclJvb20ucHJvbXB0cyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGN1cnJSb29tLnByb21wdHMuZm9yRWFjaChmdW5jdGlvbiAocHJvbXB0KSB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hpbmdQcm9tcHRSZXN1bHRzID0gcHJvbXB0Lm1hdGNoS2V5d29yZHMobWVzc2FnZSk7XHJcbiAgICAgICAgaWYgKG1hdGNoaW5nUHJvbXB0UmVzdWx0cyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgLy8gRm9yIG5vdyBqdXN0IGdldCB0aGUgZmlyc3QgbWF0Y2hpbmcgcmVzdWx0IGFuZCBzaG93IHRoYXRcclxuICAgICAgICAgIC8vIChvbmx5IG9uZSBwcm9tcHQgLyBhY3Rpb24gcGVyIG1lc3NhZ2UgaXMgc2VudCBpcyBzdXBwb3J0ZWQpXHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRk9VTkQgTUFUQ0hJTkcgUFJPTVBUIFJFU1VMVFM6ICcsIG1hdGNoaW5nUHJvbXB0UmVzdWx0cyk7XHJcbiAgICAgICAgICBfdGhpcy5EaXNwbGF5LnNob3cobWF0Y2hpbmdQcm9tcHRSZXN1bHRzLnRleHQpO1xyXG4gICAgICAgICAgLy8gR2V0IGl0ZW1zIGZyb20gcHJvbXB0IGlmIGFueSBhcmUgZm91bmRcclxuICAgICAgICAgIC8vIE1lcmdlIHRoZSBzZWNvbmQgYXJyYXkgaW50byB0aGUgZmlyc3Qgb25lXHJcbiAgICAgICAgICBpZiAobWF0Y2hpbmdQcm9tcHRSZXN1bHRzLnJlc3VsdEl0ZW1zICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoX3RoaXMuUGxheWVyLmludmVudG9yeS5pdGVtcywgbWF0Y2hpbmdQcm9tcHRSZXN1bHRzLml0ZW1zKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChtYXRjaGluZ1Byb21wdFJlc3VsdHMucmVzdWx0Um9vbSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIC8vIFN1Y2Nlc3NmdWwgcHJvbXB0IGxlYWRzIHRvIG5ldyByb29tIGVudHJhbmNlIChpZiBkZWZpbmVkIGluIHByb21wdClcclxuICAgICAgICAgICAgX3RoaXMuUGxheWVyLmN1cnJlbnRSb29tID0gbWF0Y2hpbmdQcm9tcHRSZXN1bHRzLnJvb207XHJcbiAgICAgICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiBwbGF5ZXIncyB3b25cclxuICAgICAgICAgICAgaWYgKG1hdGNoaW5nUHJvbXB0UmVzdWx0cy5Sb29tID09PSBfdGhpcy5lbmRSb29tKSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMud2luKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgbWF0Y2hpbmdQcm9tcHRSZXN1bHRzLlJvb20uZW50ZXIoX3RoaXMuUGxheWVyLmludmVudG9yeS5pdGVtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIFBsYXllciBkaWRuJ3Qgc2F5IGFueSBrZXl3b3JkcyB0aGF0IHRyaWdnZXJlZCBhbnkgb2YgdGhlIGN1cnJlbnQgcm9vbSBwcm9tcHRzXHJcbiAgICAgICAgICBfdGhpcy5EaXNwbGF5LnNob3coYDxwPk5vIGFjdGlvbnMgY291bGQgYmUgZG9uZSBmcm9tOiBcIiR7bWVzc2FnZX1cIi4gVHJ5IHNvbWV0aGluZyBlbHNlLjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtfdGhpcy5nZXRSb29tKF90aGlzLlBsYXllci5jdXJyZW50Um9vbSkuZ2V0VGV4dH1cclxuICAgICAgICAgIGApO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBObyBwcm9tcHRzIGV4aXN0IGZvciB0aGUgY3VycmVudCByb29tXHJcbiAgICAgIF90aGlzLkRpc3BsYXkuc2hvdyhgPHA+VGhlcmUgZG9lc24ndCBzZWVtIHRvIGJlIGFueSBhY3Rpb25zIGF0IGFsbCB0aGF0IHlvdSBjYW4gZG8gaW4gdGhpcyByb29tLjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHtfdGhpcy5nZXRSb29tKF90aGlzLlBsYXllci5jdXJyZW50Um9vbSkuZ2V0VGV4dH1cclxuICAgICAgYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRpc2FibGVJbnB1dCgpIHtcclxuICAgIHRoaXMuSW5wdXQuZGlzYWJsZSgpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlSW5wdXQoKSB7XHJcbiAgICB0aGlzLklucHV0LmVuYWJsZSgpO1xyXG4gIH1cclxuXHJcbiAgd2luKCkge1xyXG4gICAgLy8gU2hvdyBmaW5hbCByb29tIHRleHQgKHdpbiB0ZXh0KVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJvb21zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmICh0aGlzLnJvb21zW2ldLm5hbWUgPT09IHRoaXMuZW5kUm9vbSkge1xyXG4gICAgICAgIHRoaXMuRGlzcGxheS5zaG93KHRoaXMucm9vbXNbaV0uZ2V0VGV4dCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIERpc2FibGUgYW55IG1vcmUgdXNlciBpbnB1dCBhZnRlciB3aW5uaW5nXHJcbiAgICB0aGlzLmRpc2FibGVJbnB1dCgpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRQbGF5ZXIoKSB7XHJcbiAgICAvLyBSZXNldHMgcGxheWVyIHdpdGggYmxhbmsgaW52ZW50b3J5IGFuZCBiYWNrIHRvIHN0YXJ0aW5nIHJvb21cclxuICAgIC8vIHRoaXMuUGxheWVyID0gbmV3IFBsYXllcih0aGlzLnN0YXJ0Um9vbSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIERpc3BsYXkge1xyXG5cclxuICBjb25zdHJ1Y3RvcihodG1sID0gJycsIGVsZW1lbnRJZCA9ICdkaXNwbGF5Jykge1xyXG4gICAgdGhpcy5odG1sID0gaHRtbDtcclxuICAgIHRoaXMuZWxlbWVudElkID0gZWxlbWVudElkO1xyXG4gIH1cclxuXHJcbiAgc2hvdyhodG1sID0gbnVsbCkge1xyXG4gICAgaWYgKGh0bWwgPT09IG51bGwpIHtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5lbGVtZW50SWQpLmlubmVySFRNTCA9IHRoaXMuaHRtbDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZWxlbWVudElkKS5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgICB0aGlzLmh0bWwgPSBodG1sO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBJbnB1dCB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGRpc2FibGVkID0gZmFsc2UsIHZhbHVlID0gJycsIGVsZW1lbnRJZCA9ICdpbnB1dCcpIHtcclxuICAgIHRoaXMuZGlzYWJsZWQgPSBkaXNhYmxlZDtcclxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgIHRoaXMuZWxlbWVudElkID0gZWxlbWVudElkO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlKCkge1xyXG4gICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0JykuZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGRpc2FibGUoKSB7XHJcbiAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dCcpLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHNlbmQodmFsdWUpIHtcclxuICAgIC8vIE5vcm1hbGl6ZSBpbnB1dCB2YWx1ZXMgKGlmIGRlc2lyZWQpXHJcbiAgICB2YWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XHJcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBJbnZlbnRvcnkgZnJvbSAnLi9pbnZlbnRvcnknO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxheWVyIHtcclxuXHJcbiAgY29uc3RydWN0b3IobmFtZSA9ICdwbGF5ZXInLCBpbnZlbnRvcnkgPSBuZXcgSW52ZW50b3J5KCksIGN1cnJlbnRSb29tID0gJycsIHN0YXJ0Um9vbSkge1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuaW52ZW50b3J5ID0gaW52ZW50b3J5O1xyXG4gICAgdGhpcy5zdGFydFJvb20gPSBzdGFydFJvb207XHJcbiAgICBpZiAodGhpcy5jdXJyZW50Um9vbSA9PT0gJycpIHtcclxuICAgICAgdGhpcy5jdXJyZW50Um9vbSA9IHRoaXMuc3RhcnRSb29tO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBlbnRlclJvb20ocm9vbSkge1xyXG4gICAgY29uc3QgcmVzID0gcm9vbS5lbnRlcih0aGlzLmludmVudG9yeS5pdGVtcyk7XHJcbiAgICBpZiAocmVzWzFdID09PSBmYWxzZSkge1xyXG4gICAgICAvLyBQbGF5ZXIgZGlkIG5vdCBoYXZlIHJlcXVpcmVkIGl0ZW1zIHRvIGVudGVyIHRoZSByb29tXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBFbnRlcmVkIHJvb20gc3VjY2Vzc2Z1bGx5XHJcbiAgICAgIHRoaXMuY3VycmVudFJvb20gPSByb29tLm5hbWU7IFxyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJuIGdhbWUgdGV4dCBmcm9tIGF0dGVtcHRlZCByb29tIGVudHJ5XHJcbiAgICByZXR1cm4gW3Jlc1swXSwgcmVzWzFdXTtcclxuICB9XHJcblxyXG4gIGdldEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5pbnZlbnRvcnkuYWRkSXRlbShpdGVtKTtcclxuICAgIHJldHVybiB0aGlzLmludmVudG9yeTtcclxuICB9XHJcblxyXG4gIGRyb3BJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuaW52ZW50b3J5LmRyb3BJdGVtKGl0ZW0pO1xyXG4gICAgcmV0dXJuIHRoaXMuaW52ZW50b3J5O1xyXG4gIH1cclxuXHJcbiAgZG9BY3Rpb24odGV4dCwgaXRlbSA9IG51bGwpIHtcclxuICAgIC8vIE5vIGl0ZW0gcGFzc2VkLCBjaGVjayByb29tIHByb21wdHMgZm9yIGFjdGlvbnNcclxuICAgIGlmIChpdGVtID09PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRSb29tLmRvQWN0aW9uKHRleHQpO1xyXG4gICAgfVxyXG4gICAgLy8gRG9pbmcgYWN0aW9uIG9uIGl0ZW0sIGNoZWNrIGl0ZW0gcHJvbXB0c1xyXG4gICAgcmV0dXJuIGl0ZW0uZG9BY3Rpb24odGV4dCk7XHJcbiAgfVxyXG59XHJcbiAgXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEludmVudG9yeSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGl0ZW1zID0gW10pIHtcclxuICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcclxuICB9XHJcbiAgXHJcbiAgZXhhbWluZShpdGVtTmFtZSA9IG51bGwpIHtcclxuICAgIC8vIElmIHdlJ3JlIGV4YW1pbmluZyBhbiBpdGVtXHJcbiAgICBpZiAoaXRlbU5hbWUgIT09IG51bGwpIHtcclxuICAgICAgLy8gRGlzcGxheSBpdGVtIGdldFRleHRcclxuICAgICAgcmV0dXJuIHRoaXMuaXRlbXNbaXRlbU5hbWVdLmdldFRleHQ7XHJcbiAgICB9XHJcbiAgICAvLyBJZiB3ZSdyZSBleGFtaW5pbmcgaW52ZW50b3J5LCBwcmludCBvdXRcclxuICAgIC8vIGxpc3Qgb2YgYWxsIHRoZSBpdGVtcy5cclxuICAgIHJldHVybiB0aGlzLml0ZW1zLm1hcChhID0+IGEubmFtZSk7XHJcbiAgfVxyXG5cclxuICBnZXRJdGVtUHJvcHMoaXRlbU5hbWUpIHtcclxuICAgIHJldHVybiB0aGlzLml0ZW1zW2l0ZW1OYW1lXTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xyXG4gICAgcmV0dXJuIHRoaXMuaXRlbXM7XHJcbiAgfVxyXG5cclxuICBkcm9wSXRlbShpdGVtTmFtZSkge1xyXG4gICAgbGV0IG5ld0ludmVudG9yeSA9IHRoaXMuaXRlbXMuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0ubmFtZSAhPT0gaXRlbU5hbWU7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuaXRlbXMgPSBuZXdJbnZlbnRvcnk7XHJcbiAgICByZXR1cm4gdGhpcy5pdGVtcztcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFByb21wdCBmcm9tICcuL3Byb21wdCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb29tIHtcclxuXHJcbiAgY29uc3RydWN0b3IobmFtZSA9ICcnLCBnZXRUZXh0ID0gJycsIHByb21wdHMgPSBbXSwgcmVxdWlyZW1lbnRzID0gW10pIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLmdldFRleHQgPSBnZXRUZXh0OyAvLyBUaGUgdGV4dCB0aGF0IGlzIGRpc3BsYXllZCB3aGVuIHRoZSByb29tIGlzIGVudGVyZWRcclxuICAgIHRoaXMucHJvbXB0cyA9IHByb21wdHM7IC8vIFdoYXQgYXJlIHRoZSBhY3Rpb25zIHRoYXQgd2UgY2FuIGRvIGluIHRoaXMgcm9vbT9cclxuICAgIHRoaXMucmVxdWlyZW1lbnRzID0gcmVxdWlyZW1lbnRzOyAvLyBBbnkgcmVxdWlyZW1lbnRzIChpdGVtcykgbmVlZGVkIHRvIGFjY2VzcyB0aGUgcm9vbVxyXG4gIH1cclxuXHJcbiAgYWRkUHJvbXB0KG5hbWUsIGtleXdvcmRzLCByZXN1bHRzKSB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSBuZXcgUHJvbXB0KG5hbWUsIGtleXdvcmRzLCByZXN1bHRzKTtcclxuICAgIHRoaXMucHJvbXB0cy5wdXNoKHByb21wdCk7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9tcHRzO1xyXG4gIH1cclxuXHJcbiAgZW50ZXIoaXRlbXMgPSBbXSkge1xyXG4gICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgbGV0IG1ldEFsbFJlcXVpcmVtZW50cyA9IHRydWU7IC8vIENhbiB3ZSBlbnRlciB0aGUgcm9vbT9cclxuICAgIC8vIFRoZSByb29tIGlzIG5vdCBhY2Nlc3NpYmxlIGJ5IGRlZmF1bHRcclxuICAgIGlmICh0aGlzLnJlcXVpcmVtZW50cyA+IDApIHtcclxuICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIG1ldEFsbFJlcXVpcmVtZW50cyA9IGZhbHNlO1xyXG4gICAgICAgIC8vIFJldHVybiBtaXNzaW5nIHJlcXVpcmVtZW50IG1lc3NhZ2VzXHJcbiAgICAgICAgdGhpcy5yZXF1aXJlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAocmVxdWlyZW1lbnQpIHtcclxuICAgICAgICAgIHJlc3VsdCArPSBgJHtyZXF1aXJlbWVudC5mYWlsVGV4dH0uIGA7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgdGhlIHJvb20ncyByZXF1aXJlbWVudHMgZm9yIG1hdGNoaW5nIGl0ZW1zXHJcbiAgICAgICAgdGhpcy5yZXF1aXJlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAocmVxdWlyZW1lbnQpIHtcclxuICAgICAgICAgIGxldCBmb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtID09PSByZXF1aXJlbWVudCkge1xyXG4gICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBpZiAoZm91bmQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIG1ldEFsbFJlcXVpcmVtZW50cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyBSZXR1cm4gZmFpbCBtZXNzYWdlcyBmb3IgbWlzc2luZyByZXF1aXJlbWVudHNcclxuICAgICAgICAgICAgcmVzdWx0ICs9IHJlcXVpcmVtZW50LmZhaWxUZXh0OyAgXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKG1ldEFsbFJlcXVpcmVtZW50cyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgcmVzdWx0ID0gdGhpcy5nZXRUZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzdWx0ID0gdGhpcy5nZXRUZXh0O1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJuIHRleHQgd2l0aCByZXN1bHRzIGFuZCB3aGV0aGVyIG9yIG5vdCByb29tIGNvdWxkIGJlIGVudGVyZWRcclxuICAgIHJldHVybiBbcmVzdWx0LCBtZXRBbGxSZXF1aXJlbWVudHNdO1xyXG4gIH1cclxuXHJcbiAgZG9BY3Rpb24odmFsdWUpIHtcclxuICAgIC8vIEZvciBub3cgbGV0J3Mgb25seSBkbyBvbmUgYWN0aW9uIGF0IGEgdGltZVxyXG4gICAgbGV0IHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKHRoaXMucHJvbXB0cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmVzdWx0Wyd0ZXh0J10gPSBcIlRoZXJlIGRvZXNuJ3Qgc2VlbSB0byBiZSBhbnkgYWN0aW9ucyB5b3UgY2FuIGRvIGluIHRoaXMgcm9vbS5cIjtcclxuICAgIH1cclxuICAgIE9iamVjdC52YWx1ZXModGhpcy5wcm9tcHRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSwgdmFsKSB7IFxyXG4gICAgICBpZiAodmFsdWUgPT09IGtleSkge1xyXG4gICAgICAgIHJlc3VsdFsndGV4dCddID0gdmFsLnJlc3VsdFRleHQ7IC8vIFN1Y2Nlc3NmdWwgYWN0aW9uIHJldHVybmluZyByZXN1bHRpbmcgdGV4dFxyXG4gICAgICAgIGlmICh2YWwucmVzdWx0SXRlbXMgIT09IG51bGwpIHtcclxuICAgICAgICAgIHJlc3VsdFsnaXRlbXMnXSA9IHZhbC5yZXN1bHRJdGVtczsgLy8gU3VjY2Vzc2Z1bCBhY3Rpb24gcmVzdWx0aW5nIGluIG5ldyBpdGVtc1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsLnJlc3VsdFJvb20gIT09IG51bGwpIHtcclxuICAgICAgICAgIHJlc3VsdFsncmVzdWx0J10gPSB2YWwucmVzdWx0Um9vbTsgLy8gU3VjY2Vzc2Z1bCBhY3Rpb24gcmVzdWx0aW5nIGluIGEgbmV3IHJvb21cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvbXB0IHtcclxuICAgXHJcbiAgY29uc3RydWN0b3IobmFtZSA9ICcnLCBrZXl3b3JkcyA9IFtdLCByZXN1bHRzID0ge30pIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAvLyBLZXl3b3JkcyB0aGF0IGNhbiB0cmlnZ2VyIHRoZSBwcm9tcHQgKG1ha2UgYWxsIGxvd2VyLWNhc2UgYnkgZGVmYXVsdClcclxuICAgIHRoaXMua2V5d29yZHMgPSBrZXl3b3Jkcy5tYXAoZnVuY3Rpb24odikgeyByZXR1cm4gdi50b0xvd2VyQ2FzZSgpO30pOyBcclxuICAgIC8vIFJlc3VsdHMgdGhhdCBvY2N1ciB3aGVuIHRoaXMgcHJvbXB0IGlzIHN1Y2Nlc3NmdWxseSB0cmlnZ2VyZWQ7IFxyXG4gICAgLy8gdGhlIHJlc3VsdCBrZXlzIGNvbXByaXNlIG9mIOKAnHRleHTigJ0gKHJlcXVpcmVkKSwg4oCcaXRlbXPigJ0gKG9wdGlvbmFsKSxcclxuICAgIC8vIGFuZCDigJxyb29tIChvcHRpb25hbCnigJ0gXHJcbiAgICB0aGlzLnJlc3VsdHMgPSByZXN1bHRzOyBcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIGlucHV0IG1lc3NhZ2UgbWF0Y2hlcyBhbnkgcHJvbXB0IGtleXdvcmRzXHJcbiAgbWF0Y2hLZXl3b3JkcyhtZXNzYWdlKSB7XHJcbiAgICBsZXQgZm91bmQgPSBmYWxzZTtcclxuICAgIHRoaXMua2V5d29yZHMuZm9yRWFjaChmdW5jdGlvbihrZXl3b3JkKSB7XHJcbiAgICAgIGlmIChtZXNzYWdlLmluY2x1ZGVzKGtleXdvcmQudG9Mb3dlckNhc2UoKSkpIHtcclxuICAgICAgICBmb3VuZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgaWYgKGZvdW5kKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnJlc3VsdHM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==