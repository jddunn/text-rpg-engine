!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("text-rpg-engine",[],t):"object"==typeof exports?exports["text-rpg-engine"]=t():e["text-rpg-engine"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=t}var t,n,r;return t=e,(n=[{key:"examine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==e?this.items[e].getText:this.items.map(function(e){return e.name})}},{key:"addItem",value:function(e){return this.items.push(e),this.items}},{key:"dropItem",value:function(e){var t=this.items.filter(function(t){return t.name!==e});return this.items=t,this.items}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new(((o=n(2))&&o.__esModule?o:{default:o}).default);t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(n(3)),r=l(n(4)),i=l(n(5)),a=l(n(6)),s=l(n(0)),u=l(n(8));function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Display=new o.default,this.Input=new r.default,this.datapath=t,this.rooms=n,this.items=a,this.startRoom=s,this.endRoom=u,this.Player=new i.default(s=this.startRoom)}var t,n,l;return t=e,(n=[{key:"init",value:function(){var e;""!==this.dataPath&&console.log("Initialized game from: "+this.datapath),""===this.startRoom&&this.rooms.length>0&&(this.startRoom=this.rooms[0].name,this.Player.startRoom=this.startRoom,this.Player.currentRoom=this.Player.startRoom),""===this.endRoom&&this.rooms.length>1&&(this.endRoom=this.rooms[this.rooms.length-1].name);for(var t=0;t<this.rooms.length;t++)if(this.rooms[t].name===this.startRoom){e=this.rooms[t].getText;break}void 0===e&&(e="No starting room text found!"),this.Display.show(e)}},{key:"addRoom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=new a.default(e,t,n,o);return this.rooms.push(r),r}},{key:"dropRoom",value:function(e){var t=this.rooms.filter(function(t){return t.name!==e});return this.rooms=t,this.rooms}},{key:"getRoom",value:function(e){return this.rooms.find(function(t){return t.name===e})}},{key:"addItem",value:function(e,t){var n=new u.default(e,t);return this.items.push(n),this.items}},{key:"dropItem",value:function(e){var t=this.items.filter(function(t){return t.name!==e});return this.items=t,this.items}},{key:"getItem",value:function(e){return this.items.find(function(t){return t.name===e})}},{key:"userSend",value:function(e){this.Input.send(e),this.decidePath(this.Input.value)}},{key:"decidePath",value:function(e){"restart"===e&&this.resetGame();var t=this,n=t.getRoom(t.Player.currentRoom);if(void 0!==c(n.prompts)){var o=!1;n.prompts.forEach(function(n){if(!1===o){var r=n.matchKeywords(e);if(null!==r){if(o=!0,"success"in r&&(t.Display.show(r.success.successText),void 0!==r.success.itemsGiven&&Array.prototype.push.apply(t.Player.inventory.items,r.success.itemsGiven),void 0!==r.success.roomToEnter)){var i,a,s=f(t.Player.enterRoom(this.getRoom(r.success.roomToEnter)),2);a=s[0],i=s[1],r.success.roomToEnter===t.endRoom&&(i?t.win():t.Display.append(a))}if("fail"in r)return console.log("fail is in matching prompt"),t.Display.show("".concat(n.results.failMessage)),void t.Display.append("Missing required items: ".concat(r.fail.toString()))}}else!1===o&&t.Display.show('<p>No actions could be done from: "'.concat(e,'". Try something else.</p>\n            ').concat(t.getRoom(t.Player.currentRoom).getText,"\n          "))})}else console.log("UNDEFINED PROMPTS"),t.Display.show("<p>There doesn't seem to be any actions at all that you can do in this room.</p>\n                        ".concat(t.getRoom(t.Player.currentRoom).getText,"\n      "));console.log(e,this.Player)}},{key:"disableInput",value:function(){this.Input.disable()}},{key:"enableInput",value:function(){this.Input.enable()}},{key:"win",value:function(){for(var e=0;e<this.rooms.length;e++)this.rooms[e].name===this.endRoom&&(this.Display.append(this.rooms[e].getText),this.Display.append("<p>Game end.</p>"));this.disableInput()}},{key:"resetGame",value:function(){this.Player.inventory=new s.default,this.Player.currentRoom=this.startRoom;var e=this.getRoom(this.startRoom);this.Display.show(e.getText),this.Input.enable()}}])&&h(t.prototype,n),l&&h(t,l),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"display";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.html=t,this.elementId=n}var t,n,r;return t=e,(n=[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e?document.getElementById(this.elementId).innerHTML=this.html:(document.getElementById(this.elementId).innerHTML=e,this.html=e)}},{key:"append",value:function(e){document.getElementById(this.elementId).innerHTML+=e}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"input";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.disabled=t,this.value=n,this.elementId=o}var t,n,r;return t=e,(n=[{key:"enable",value:function(){this.disabled=!1,document.getElementById("input").disabled=!1}},{key:"disable",value:function(){this.disabled=!0,document.getElementById("input").disabled=!0}},{key:"send",value:function(e){e=e.toLowerCase(),this.value=e}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(0))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.default,o=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments[3]);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,""===this.name&&(this.name="player"),this.inventory=n,""===this.currentRoom&&(this.currentRoom=this.startRoom),this.startRoom=o}var t,n,o;return t=e,(n=[{key:"enterRoom",value:function(e){var t=e.enter(this.inventory.items);return!1===t[1]||(this.currentRoom=e.name),[t[0],t[1]]}},{key:"getItem",value:function(e){return this.inventory.addItem(e),this.inventory}},{key:"dropItem",value:function(e){return this.inventory.dropItem(e),this.inventory}},{key:"doAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t?this.currentRoom.doAction(e):t.doAction(e)}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(7))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.getText=n,this.prompts=o,this.requirements=r}var t,n,o;return t=e,(n=[{key:"addPrompt",value:function(e,t,n){var o=new r.default(e,t,n);return this.prompts.push(o),this.prompts}},{key:"enter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="",n=!0;return this.requirements>0?0===e.length?(n=!1,this.requirements.forEach(function(e){t+="".concat(e.failText,". ")})):(this.requirements.forEach(function(e){var o=!1;this.items.forEach(function(t){t===e&&(o=!0)}),!1===o&&(n=!1,t+=e.failText)}),!0===n&&(t=this.getText)):t=this.getText,[t,n]}},{key:"doAction",value:function(e){var t={};return 0===this.prompts.length&&(t.text="There doesn't seem to be any actions you can do in this room."),Object.values(this.prompts).forEach(function(n,o){e===n&&(t.text=o.resultTextText,null!==o.resultTextItems&&(t.items=o.resultTextItems),null!==o.resultTextRoom&&(t.resultText=o.resultTextRoom))}),t}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.keywords=n.map(function(e){return e.toLowerCase()}),this.results=o,this.requirements=r}var t,n,r;return t=e,(n=[{key:"matchKeywords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1;if(this.requirements.length>0){var o=[];if(this.requirements.forEach(function(e){var n=!1;t.forEach(function(t){t===e&&(n=!0)}),n||o.push(e)}),o.length>0)return{fail:o}}return this.keywords.forEach(function(t){e.includes(t.toLowerCase())&&(n=!0)}),n?{success:this.results}:null}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.getText=n}var t,n,r;return t=e,(n=[{key:"get",value:function(){return this.getText}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r,e.exports=t.default}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL3RleHQtcnBnLWVuZ2luZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvaW52ZW50b3J5LmpzIiwid2VicGFjazovL3RleHQtcnBnLWVuZ2luZS8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvZ2FtZS5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvZGlzcGxheS5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvaW5wdXQuanMiLCJ3ZWJwYWNrOi8vdGV4dC1ycGctZW5naW5lLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvcm9vbS5qcyIsIndlYnBhY2s6Ly90ZXh0LXJwZy1lbmdpbmUvLi9zcmMvcHJvbXB0LmpzIiwid2VicGFjazovL3RleHQtcnBnLWVuZ2luZS8uL3NyYy9pdGVtLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInNlbGYiLCJ0aGlzIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkludmVudG9yeSIsIml0ZW1zIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2NsYXNzQ2FsbENoZWNrIiwiaXRlbU5hbWUiLCJnZXRUZXh0IiwibWFwIiwiYSIsIml0ZW0iLCJwdXNoIiwibmV3SW52ZW50b3J5IiwiZmlsdGVyIiwiZGVmYXVsdCIsIl9kaXNwbGF5IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9pbnB1dCIsIl9wbGF5ZXIiLCJfcm9vbSIsIl9pbnZlbnRvcnkiLCJfaXRlbSIsIkdhbWUiLCJkYXRhcGF0aCIsInJvb21zIiwic3RhcnRSb29tIiwiZW5kUm9vbSIsIkRpc3BsYXkiLCJJbnB1dCIsIlBsYXllciIsImRpc3BsYXlUZXh0IiwiZGF0YVBhdGgiLCJjb25zb2xlIiwibG9nIiwiY3VycmVudFJvb20iLCJzaG93IiwicHJvbXB0cyIsInJlcXVpcmVtZW50cyIsInJvb21PYmoiLCJyb29tTmFtZSIsIm5ld1Jvb21zIiwicm9vbSIsImZpbmQiLCJ4IiwibmV3SXRlbXMiLCJtZXNzYWdlIiwic2VuZCIsImRlY2lkZVBhdGgiLCJyZXNldEdhbWUiLCJfdGhpcyIsImN1cnJSb29tIiwiZ2V0Um9vbSIsIl90eXBlb2YiLCJmb3VuZFByb21wdCIsImZvckVhY2giLCJwcm9tcHQiLCJtYXRjaGluZ1Byb21wdFJlc3VsdHMiLCJtYXRjaEtleXdvcmRzIiwic3VjY2VzcyIsInN1Y2Nlc3NUZXh0IiwiaXRlbXNHaXZlbiIsIkFycmF5IiwiYXBwbHkiLCJpbnZlbnRvcnkiLCJyb29tVG9FbnRlciIsImVudGVyUm9vbVJlc3VsdFN1Y2Nlc3MiLCJlbnRlclJvb21SZXN1bHRUZXh0IiwiX3RoaXMkUGxheWVyJGVudGVyUm9vMiIsIl9zbGljZWRUb0FycmF5IiwiZW50ZXJSb29tIiwid2luIiwiYXBwZW5kIiwiY29uY2F0IiwicmVzdWx0cyIsImZhaWxNZXNzYWdlIiwiZmFpbCIsInRvU3RyaW5nIiwiZGlzYWJsZSIsImVuYWJsZSIsImRpc2FibGVJbnB1dCIsImh0bWwiLCJlbGVtZW50SWQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwiZGlzYWJsZWQiLCJ0b0xvd2VyQ2FzZSIsInJlcyIsImVudGVyIiwiYWRkSXRlbSIsImRyb3BJdGVtIiwidGV4dCIsImRvQWN0aW9uIiwiX3Byb21wdCIsIlJvb20iLCJrZXl3b3JkcyIsInJlc3VsdFRleHRzIiwicmVzdWx0VGV4dCIsIm1ldEFsbFJlcXVpcmVtZW50cyIsInJlcXVpcmVtZW50IiwiZmFpbFRleHQiLCJmb3VuZCIsInZhbHVlcyIsInZhbCIsInJlc3VsdFRleHRUZXh0IiwicmVzdWx0VGV4dEl0ZW1zIiwicmVzdWx0VGV4dFJvb20iLCJQcm9tcHQiLCJ2IiwiZm91bmRLZXl3b3JkIiwibWlzc2luZ1JlcXVpcmVtZW50cyIsImZvdW5kUmVxdWlyZW1lbnQiLCJrZXl3b3JkIiwiaW5jbHVkZXMiLCJJdGVtIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLGlCQUFBQyxTQUFBLGlCQUFBQyxPQUNBQSxPQUFBRCxRQUFBRCxJQUNBLG1CQUFBRyxlQUFBQyxJQUNBRCxPQUFBLHFCQUFBSCxHQUNBLGlCQUFBQyxRQUNBQSxRQUFBLG1CQUFBRCxJQUVBRCxFQUFBLG1CQUFBQyxJQVJBLENBU0Msb0JBQUFLLFVBQUFDLEtBQUEsV0FDRCxtQkNUQSxJQUFBQyxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFSLFFBR0EsSUFBQUMsRUFBQUssRUFBQUUsR0FBQSxDQUNBQyxFQUFBRCxFQUNBRSxHQUFBLEVBQ0FWLFFBQUEsSUFVQSxPQU5BVyxFQUFBSCxHQUFBSSxLQUFBWCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBTyxHQUdBTixFQUFBUyxHQUFBLEVBR0FULEVBQUFELFFBMERBLE9BckRBTyxFQUFBTSxFQUFBRixFQUdBSixFQUFBTyxFQUFBUixFQUdBQyxFQUFBUSxFQUFBLFNBQUFmLEVBQUFnQixFQUFBQyxHQUNBVixFQUFBVyxF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USxHQUFxQixJQUFaNUMsRUFBWUMsVUFBQUMsT0FBQSxRQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBSixHQUN6QjJHLEdBQWUsRUFDbkIsR0FBSWpKLEtBQUt5RSxhQUFhbEMsT0FBUyxFQUFHLENBQ2hDLElBQUkyRyxFQUFzQixHQVkxQixHQVhBbEosS0FBS3lFLGFBQWFpQixRQUFRLFNBQVM2QyxHQUNqQyxJQUFJWSxHQUFtQixFQUN2QjlHLEVBQU1xRCxRQUFRLFNBQVM1QyxHQUNqQkEsSUFBU3lGLElBQ1hZLEdBQW1CLEtBR2xCQSxHQUNIRCxFQUFvQm5HLEtBQUt3RixLQUd6QlcsRUFBb0IzRyxPQUFTLEVBQy9CLE1BQU8sQ0FBQ3dFLEtBQVFtQyxHQVFwQixPQUxBbEosS0FBS21JLFNBQVN6QyxRQUFRLFNBQVMwRCxHQUN6Qm5FLEVBQVFvRSxTQUFTRCxFQUFRMUIsaUJBQzNCdUIsR0FBZSxLQUdmQSxFQUNLLENBQUNuRCxRQUFXOUYsS0FBSzZHLFNBRW5CLG9WQzFDVXlDLGFBRW5CLFNBQUFBLElBQXFDLElBQXpCM0ksRUFBeUIyQixVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFsQixHQUFJSyxFQUFjTCxVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFKLGdHQUFJRyxDQUFBekMsS0FBQXNKLEdBQ25DdEosS0FBS1csS0FBT0EsRUFDWlgsS0FBSzJDLFFBQVVBLHVEQUlmLE9BQU8zQyxLQUFLMkMiLCJmaWxlIjoidGV4dC1ycGctZW5naW5lLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwidGV4dC1ycGctZW5naW5lXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInRleHQtcnBnLWVuZ2luZVwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJ0ZXh0LXJwZy1lbmdpbmVcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW52ZW50b3J5IHtcclxuXHJcbiAgY29uc3RydWN0b3IoaXRlbXMgPSBbXSkge1xyXG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xyXG4gIH1cclxuICBcclxuICBleGFtaW5lKGl0ZW1OYW1lID0gbnVsbCkge1xyXG4gICAgLy8gSWYgd2UncmUgZXhhbWluaW5nIGFuIGl0ZW1cclxuICAgIGlmIChpdGVtTmFtZSAhPT0gbnVsbCkge1xyXG4gICAgICAvLyBEaXNwbGF5IGl0ZW0gZ2V0VGV4dFxyXG4gICAgICByZXR1cm4gdGhpcy5pdGVtc1tpdGVtTmFtZV0uZ2V0VGV4dDtcclxuICAgIH1cclxuICAgIC8vIElmIHdlJ3JlIGV4YW1pbmluZyBpbnZlbnRvcnksIHByaW50IG91dFxyXG4gICAgLy8gbGlzdCBvZiBhbGwgdGhlIGl0ZW1zLlxyXG4gICAgcmV0dXJuIHRoaXMuaXRlbXMubWFwKGEgPT4gYS5uYW1lKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xyXG4gICAgcmV0dXJuIHRoaXMuaXRlbXM7XHJcbiAgfVxyXG5cclxuICBkcm9wSXRlbShpdGVtTmFtZSkge1xyXG4gICAgbGV0IG5ld0ludmVudG9yeSA9IHRoaXMuaXRlbXMuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0ubmFtZSAhPT0gaXRlbU5hbWU7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuaXRlbXMgPSBuZXdJbnZlbnRvcnk7XHJcbiAgICByZXR1cm4gdGhpcy5pdGVtcztcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJztcclxuXHJcbmNvbnN0IGdhbWUgPSBuZXcgR2FtZSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZ2FtZTtcclxuIiwiaW1wb3J0IERpc3BsYXkgZnJvbSAnLi9kaXNwbGF5JztcclxuaW1wb3J0IElucHV0IGZyb20gJy4vaW5wdXQnO1xyXG5pbXBvcnQgUGxheWVyIGZyb20gJy4vcGxheWVyJztcclxuaW1wb3J0IFJvb20gZnJvbSAnLi9yb29tJztcclxuaW1wb3J0IEludmVudG9yeSBmcm9tICcuL2ludmVudG9yeSc7XHJcbmltcG9ydCBJdGVtIGZyb20gJy4vaXRlbSc7XHJcbi8vIGltcG9ydCBJdGVtIGZyb20gJy4vaXRlbSc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcclxuXHJcbiAgY29uc3RydWN0b3IoZGF0YXBhdGggPSAnJywgcm9vbXMgPSBbXSwgaXRlbXMgPSBbXSwgc3RhcnRSb29tID0gJycsIGVuZFJvb20gPSAnJykge1xyXG4gICAgdGhpcy5EaXNwbGF5ID0gbmV3IERpc3BsYXkoKTtcclxuICAgIHRoaXMuSW5wdXQgPSBuZXcgSW5wdXQoKTtcclxuICAgIHRoaXMuZGF0YXBhdGggPSBkYXRhcGF0aDsgLy8gVE9ETzogQmUgYWJsZSB0byBoYXZlIGdhbWUgaW5pdGlhbGl6ZSBkYXRhIGZyb20gSlNPTiBmaWxlXHJcbiAgICB0aGlzLnJvb21zID0gcm9vbXM7IC8vIEFsbCB0aGUgcm9vbXMgaW4gb3VyIGdhbWVcclxuICAgIHRoaXMuaXRlbXMgPSBpdGVtczsgLy8gQWxsIHRoZSBpdGVtcyBpbiBvdXIgZ2FtZVxyXG4gICAgdGhpcy5zdGFydFJvb20gPSBzdGFydFJvb207IC8vIFdoaWNoIHJvb20gd2lsbCB0aGUgcGxheWVyIHN0YXJ0IGluXHJcbiAgICB0aGlzLmVuZFJvb20gPSBlbmRSb29tOyAvLyBXaGljaCByb29tIFxyXG4gICAgLy8gVE9ETzogQWxsb3cgcGxheWVycyB0byBnaXZlIHRoZWlyIGNoYXJhY3RlcnMgdGhlaXIgb3duIG5hbWVzIGxhdGVyXHJcbiAgICB0aGlzLlBsYXllciA9IG5ldyBQbGF5ZXIoc3RhcnRSb29tID0gdGhpcy5zdGFydFJvb20pOyBcclxuICB9XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICBsZXQgZGlzcGxheVRleHQ7XHJcbiAgICBpZiAodGhpcy5kYXRhUGF0aCAhPT0gJycpIHtcclxuICAgICAgLy8gdGhpcy5sb2FkRGF0YSh0aGlzLmRhdGFQYXRoKTtcclxuICAgICAgY29uc29sZS5sb2coJ0luaXRpYWxpemVkIGdhbWUgZnJvbTogJyArIHRoaXMuZGF0YXBhdGgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuc3RhcnRSb29tID09PSAnJyAmJiB0aGlzLnJvb21zLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5zdGFydFJvb20gPSB0aGlzLnJvb21zWzBdLm5hbWU7IFxyXG4gICAgICB0aGlzLlBsYXllci5zdGFydFJvb20gPSB0aGlzLnN0YXJ0Um9vbTtcclxuICAgICAgdGhpcy5QbGF5ZXIuY3VycmVudFJvb20gPSB0aGlzLlBsYXllci5zdGFydFJvb207XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5lbmRSb29tID09PSAnJyAmJiB0aGlzLnJvb21zLmxlbmd0aCA+IDEpIHtcclxuICAgICAgdGhpcy5lbmRSb29tID0gdGhpcy5yb29tc1t0aGlzLnJvb21zLmxlbmd0aCAtIDFdLm5hbWU7ICAgICAgXHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucm9vbXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKHRoaXMucm9vbXNbaV0ubmFtZSA9PT0gdGhpcy5zdGFydFJvb20pIHtcclxuICAgICAgICBkaXNwbGF5VGV4dCA9IHRoaXMucm9vbXNbaV0uZ2V0VGV4dDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGRpc3BsYXlUZXh0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgZGlzcGxheVRleHQgPSAnTm8gc3RhcnRpbmcgcm9vbSB0ZXh0IGZvdW5kISc7XHJcbiAgICB9XHJcbiAgICB0aGlzLkRpc3BsYXkuc2hvdyhkaXNwbGF5VGV4dCk7XHJcbiAgfVxyXG5cclxuICBhZGRSb29tKG5hbWUsIGdldFRleHQsIHByb21wdHMgPSBbXSwgcmVxdWlyZW1lbnRzID0gW10pIHtcclxuICAgIGxldCByb29tT2JqID0gbmV3IFJvb20obmFtZSwgZ2V0VGV4dCwgcHJvbXB0cywgcmVxdWlyZW1lbnRzKTtcclxuICAgIHRoaXMucm9vbXMucHVzaChyb29tT2JqKTtcclxuICAgIHJldHVybiByb29tT2JqO1xyXG4gIH1cclxuXHJcbiAgZHJvcFJvb20ocm9vbU5hbWUpIHtcclxuICAgIGxldCBuZXdSb29tcyA9IHRoaXMucm9vbXMuZmlsdGVyKGZ1bmN0aW9uKHJvb20pIHtcclxuICAgICAgcmV0dXJuIHJvb20ubmFtZSAhPT0gcm9vbU5hbWU7XHJcbiAgICB9KTtcclxuICAgIHRoaXMucm9vbXMgPSBuZXdSb29tcztcclxuICAgIHJldHVybiB0aGlzLnJvb21zO1xyXG4gIH1cclxuXHJcbiAgZ2V0Um9vbShyb29tTmFtZSkge1xyXG4gICAgY29uc3Qgcm9vbSA9IHRoaXMucm9vbXMuZmluZCh4ID0+IHgubmFtZSA9PT0gcm9vbU5hbWUpO1xyXG4gICAgcmV0dXJuIHJvb207XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKG5hbWUsIGdldFRleHQpIHtcclxuICAgIGNvbnN0IGl0ZW0gPSBuZXcgSXRlbShuYW1lLCBnZXRUZXh0KTtcclxuICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcclxuICAgIHJldHVybiB0aGlzLml0ZW1zO1xyXG4gIH1cclxuXHJcbiAgZHJvcEl0ZW0oaXRlbU5hbWUpIHtcclxuICAgIGxldCBuZXdJdGVtcyA9IHRoaXMuaXRlbXMuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0ubmFtZSAhPT0gaXRlbU5hbWU7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuaXRlbXMgPSBuZXdJdGVtcztcclxuICAgIHJldHVybiB0aGlzLml0ZW1zO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXRlbShpdGVtTmFtZSkge1xyXG4gICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXMuZmluZCh4ID0+IHgubmFtZSA9PT0gaXRlbU5hbWUpO1xyXG4gICAgcmV0dXJuIGl0ZW07XHJcbiAgfVxyXG5cclxuICB1c2VyU2VuZChtZXNzYWdlKSB7XHJcbiAgICAvLyBPdXIgSW5wdXQgY2xhc3Mgd2lsbCBoYW5kbGUgY2xlYW5pbmcgLyBub3JtYWxpemluZyBzdHJpbmdzXHJcbiAgICB0aGlzLklucHV0LnNlbmQobWVzc2FnZSk7XHJcbiAgICB0aGlzLmRlY2lkZVBhdGgodGhpcy5JbnB1dC52YWx1ZSk7XHJcbiAgfVxyXG5cclxuICBkZWNpZGVQYXRoKG1lc3NhZ2UpIHtcclxuICAgIGlmIChtZXNzYWdlID09PSAncmVzdGFydCcpIHtcclxuICAgICAgdGhpcy5yZXNldEdhbWUoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IF90aGlzID0gdGhpcztcclxuICAgIGNvbnN0IGN1cnJSb29tID0gX3RoaXMuZ2V0Um9vbShfdGhpcy5QbGF5ZXIuY3VycmVudFJvb20pO1xyXG5cclxuICAgIC8vIERvIHdlIGhhdmUgYWN0aW9ucyB0aGF0IHdlIGNhbiBkbyBpbiB0aGUgcm9vbT9cclxuICBcclxuICAgIGlmICh0eXBlb2YgY3VyclJvb20ucHJvbXB0cyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIC8vIENoZWNrIGV2ZXJ5IHByb21wdCBhY3Rpb24gdG8gc2VlIGlmIGl0IG1hdGNoZXMgb3VyIGlucHV0IGtleXdvcmRzXHJcbiAgICAgIC8vIEZvciBub3cganVzdCBnZXQgdGhlIGZpcnN0IG1hdGNoaW5nIHByb21wdCBhbmQgZG8gdGhhdFxyXG4gICAgICBsZXQgZm91bmRQcm9tcHQgPSBmYWxzZTtcclxuICAgICAgY3VyclJvb20ucHJvbXB0cy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9tcHQpIHtcclxuICAgICAgICBpZiAoZm91bmRQcm9tcHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICBjb25zdCBtYXRjaGluZ1Byb21wdFJlc3VsdHMgPSBwcm9tcHQubWF0Y2hLZXl3b3JkcyhtZXNzYWdlKTtcclxuICAgICAgICAgIC8vIElmIHdlIGdldCBhIG1hdGNoaW5nIHJlc3VsdCBiYWNrXHJcbiAgICAgICAgICBpZiAobWF0Y2hpbmdQcm9tcHRSZXN1bHRzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGZvdW5kUHJvbXB0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKCdzdWNjZXNzJyBpbiBtYXRjaGluZ1Byb21wdFJlc3VsdHMpIHtcclxuICAgICAgICAgICAgICBfdGhpcy5EaXNwbGF5LnNob3cobWF0Y2hpbmdQcm9tcHRSZXN1bHRzLnN1Y2Nlc3Muc3VjY2Vzc1RleHQpO1xyXG4gICAgICAgICAgICAgIC8vIEdldCBpdGVtcyBmcm9tIHByb21wdCBpZiBhbnkgYXJlIGZvdW5kXHJcbiAgICAgICAgICAgICAgaWYgKG1hdGNoaW5nUHJvbXB0UmVzdWx0cy5zdWNjZXNzLml0ZW1zR2l2ZW4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoX3RoaXMuUGxheWVyLmludmVudG9yeS5pdGVtcywgbWF0Y2hpbmdQcm9tcHRSZXN1bHRzLnN1Y2Nlc3MuaXRlbXNHaXZlbik7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIC8vIFN1Y2Nlc3NmdWwgcHJvbXB0IGxlYWRzIHRvIG5ldyByb29tIGVudHJhbmNlIChpZiBkZWZpbmVkIGluIHByb21wdClcclxuICAgICAgICAgICAgICBpZiAobWF0Y2hpbmdQcm9tcHRSZXN1bHRzLnN1Y2Nlc3Mucm9vbVRvRW50ZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGVudGVyUm9vbVJlc3VsdFN1Y2Nlc3M7XHJcbiAgICAgICAgICAgICAgICBsZXQgZW50ZXJSb29tUmVzdWx0VGV4dDsgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgW2VudGVyUm9vbVJlc3VsdFRleHQsIGVudGVyUm9vbVJlc3VsdFN1Y2Nlc3NdID0gXHJcbiAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5QbGF5ZXIuZW50ZXJSb29tKHRoaXMuZ2V0Um9vbShtYXRjaGluZ1Byb21wdFJlc3VsdHMuc3VjY2Vzcy5yb29tVG9FbnRlcikpO1xyXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHBsYXllcidzIHdvblxyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoaW5nUHJvbXB0UmVzdWx0cy5zdWNjZXNzLnJvb21Ub0VudGVyID09PSBfdGhpcy5lbmRSb29tKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChlbnRlclJvb21SZXN1bHRTdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU3VjY2Vzc2Z1bGx5IGVudGVyZWQgcm9vbSB0byB3aW4gZ2FtZVxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLndpbigpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgcmVzdWx0cyB0ZXh0IChmYWlsIHRvIGVudGVyIHdpbm5pbmcgcm9vbSlcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5EaXNwbGF5LmFwcGVuZChlbnRlclJvb21SZXN1bHRUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAvLyByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIGRvIHByb21wdCAobWlzc2luZyBpdGVtIHJlcXVpcmVtZW50KVxyXG4gICAgICAgICAgICBpZiAoJ2ZhaWwnIGluIG1hdGNoaW5nUHJvbXB0UmVzdWx0cykge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmYWlsIGlzIGluIG1hdGNoaW5nIHByb21wdCcpO1xyXG4gICAgICAgICAgICAgIF90aGlzLkRpc3BsYXkuc2hvdyhgJHtwcm9tcHQucmVzdWx0cy5mYWlsTWVzc2FnZX1gKTtcclxuICAgICAgICAgICAgICBfdGhpcy5EaXNwbGF5LmFwcGVuZChgTWlzc2luZyByZXF1aXJlZCBpdGVtczogJHttYXRjaGluZ1Byb21wdFJlc3VsdHMuZmFpbC50b1N0cmluZygpfWApO1xyXG4gICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoZm91bmRQcm9tcHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIC8vIFBsYXllciBkaWRuJ3Qgc2F5IGFueSBrZXl3b3JkcyB0aGF0IHRyaWdnZXJlZCBhbnkgb2YgdGhlIGN1cnJlbnQgcm9vbSBwcm9tcHRzXHJcbiAgICAgICAgICAgIF90aGlzLkRpc3BsYXkuc2hvdyhgPHA+Tm8gYWN0aW9ucyBjb3VsZCBiZSBkb25lIGZyb206IFwiJHttZXNzYWdlfVwiLiBUcnkgc29tZXRoaW5nIGVsc2UuPC9wPlxyXG4gICAgICAgICAgICAke190aGlzLmdldFJvb20oX3RoaXMuUGxheWVyLmN1cnJlbnRSb29tKS5nZXRUZXh0fVxyXG4gICAgICAgICAgYCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIE5vIHByb21wdHMgZXhpc3QgZm9yIHRoZSBjdXJyZW50IHJvb21cclxuICAgICAgY29uc29sZS5sb2coJ1VOREVGSU5FRCBQUk9NUFRTJyk7XHJcbiAgICAgIF90aGlzLkRpc3BsYXkuc2hvdyhgPHA+VGhlcmUgZG9lc24ndCBzZWVtIHRvIGJlIGFueSBhY3Rpb25zIGF0IGFsbCB0aGF0IHlvdSBjYW4gZG8gaW4gdGhpcyByb29tLjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHtfdGhpcy5nZXRSb29tKF90aGlzLlBsYXllci5jdXJyZW50Um9vbSkuZ2V0VGV4dH1cclxuICAgICAgYCk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhtZXNzYWdlLCB0aGlzLlBsYXllcik7XHJcblxyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUlucHV0KCkge1xyXG4gICAgdGhpcy5JbnB1dC5kaXNhYmxlKCk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVJbnB1dCgpIHtcclxuICAgIHRoaXMuSW5wdXQuZW5hYmxlKCk7XHJcbiAgfVxyXG5cclxuICB3aW4oKSB7XHJcbiAgICAvLyBTaG93IGZpbmFsIHJvb20gdGV4dCAod2luIHRleHQpXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucm9vbXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKHRoaXMucm9vbXNbaV0ubmFtZSA9PT0gdGhpcy5lbmRSb29tKSB7XHJcbiAgICAgICAgdGhpcy5EaXNwbGF5LmFwcGVuZCh0aGlzLnJvb21zW2ldLmdldFRleHQpO1xyXG4gICAgICAgIHRoaXMuRGlzcGxheS5hcHBlbmQoJzxwPkdhbWUgZW5kLjwvcD4nKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gRGlzYWJsZSBhbnkgbW9yZSB1c2VyIGlucHV0IGFmdGVyIHdpbm5pbmdcclxuICAgIHRoaXMuZGlzYWJsZUlucHV0KCk7XHJcbiAgfVxyXG5cclxuICByZXNldEdhbWUoKSB7XHJcbiAgICAvLyBSZXNldHMgcGxheWVyIHdpdGggYmxhbmsgaW52ZW50b3J5IGFuZCBiYWNrIHRvIHN0YXJ0aW5nIHJvb21cclxuICAgIHRoaXMuUGxheWVyLmludmVudG9yeSA9IG5ldyBJbnZlbnRvcnkoKTtcclxuICAgIHRoaXMuUGxheWVyLmN1cnJlbnRSb29tID0gdGhpcy5zdGFydFJvb207XHJcbiAgICBjb25zdCByb29tID0gdGhpcy5nZXRSb29tKHRoaXMuc3RhcnRSb29tKTtcclxuICAgIHRoaXMuRGlzcGxheS5zaG93KHJvb20uZ2V0VGV4dCk7XHJcbiAgICB0aGlzLklucHV0LmVuYWJsZSgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEaXNwbGF5IHtcclxuXHJcbiAgY29uc3RydWN0b3IoaHRtbCA9ICcnLCBlbGVtZW50SWQgPSAnZGlzcGxheScpIHtcclxuICAgIHRoaXMuaHRtbCA9IGh0bWw7XHJcbiAgICB0aGlzLmVsZW1lbnRJZCA9IGVsZW1lbnRJZDtcclxuICB9XHJcblxyXG4gIHNob3coaHRtbCA9IG51bGwpIHtcclxuICAgIGlmIChodG1sID09PSBudWxsKSB7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZWxlbWVudElkKS5pbm5lckhUTUwgPSB0aGlzLmh0bWw7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVsZW1lbnRJZCkuaW5uZXJIVE1MID0gaHRtbDtcclxuICAgICAgdGhpcy5odG1sID0gaHRtbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFwcGVuZChodG1sKSB7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVsZW1lbnRJZCkuaW5uZXJIVE1MICs9IGh0bWw7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIElucHV0IHtcclxuXHJcbiAgY29uc3RydWN0b3IoZGlzYWJsZWQgPSBmYWxzZSwgdmFsdWUgPSAnJywgZWxlbWVudElkID0gJ2lucHV0Jykge1xyXG4gICAgdGhpcy5kaXNhYmxlZCA9IGRpc2FibGVkO1xyXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgdGhpcy5lbGVtZW50SWQgPSBlbGVtZW50SWQ7XHJcbiAgfVxyXG5cclxuICBlbmFibGUoKSB7XHJcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXQnKS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZSgpIHtcclxuICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0JykuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgc2VuZCh2YWx1ZSkge1xyXG4gICAgLy8gTm9ybWFsaXplIGlucHV0IHZhbHVlcyAoaWYgZGVzaXJlZClcclxuICAgIHZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcclxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IEludmVudG9yeSBmcm9tICcuL2ludmVudG9yeSc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbGF5ZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihuYW1lID0gJycsIGludmVudG9yeSA9IG5ldyBJbnZlbnRvcnkoKSwgY3VycmVudFJvb20gPSAnJywgc3RhcnRSb29tKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgaWYgKHRoaXMubmFtZSA9PT0gJycpIHtcclxuICAgICAgdGhpcy5uYW1lID0gJ3BsYXllcic7XHJcbiAgICB9XHJcbiAgICB0aGlzLmludmVudG9yeSA9IGludmVudG9yeTtcclxuICAgIGlmICh0aGlzLmN1cnJlbnRSb29tID09PSAnJykge1xyXG4gICAgICB0aGlzLmN1cnJlbnRSb29tID0gdGhpcy5zdGFydFJvb207XHJcbiAgICB9XHJcbiAgICB0aGlzLnN0YXJ0Um9vbSA9IHN0YXJ0Um9vbTtcclxuICB9XHJcbiAgXHJcbiAgZW50ZXJSb29tKHJvb20pIHtcclxuICAgIGNvbnN0IHJlcyA9IHJvb20uZW50ZXIodGhpcy5pbnZlbnRvcnkuaXRlbXMpO1xyXG4gICAgaWYgKHJlc1sxXSA9PT0gZmFsc2UpIHtcclxuICAgICAgLy8gUGxheWVyIGRpZCBub3QgaGF2ZSByZXF1aXJlZCBpdGVtcyB0byBlbnRlciB0aGUgcm9vbVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gRW50ZXJlZCByb29tIHN1Y2Nlc3NmdWxseVxyXG4gICAgICB0aGlzLmN1cnJlbnRSb29tID0gcm9vbS5uYW1lOyBcclxuICAgIH1cclxuICAgIC8vIFJldHVybiBnYW1lIHRleHQgYW5kIHdoZXRoZXIgb3Igbm90IHdlIHdlcmUgYWJsZSB0byBlbnRlciByb29tXHJcbiAgICByZXR1cm4gW3Jlc1swXSwgcmVzWzFdXTtcclxuICB9XHJcblxyXG4gIGdldEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5pbnZlbnRvcnkuYWRkSXRlbShpdGVtKTtcclxuICAgIHJldHVybiB0aGlzLmludmVudG9yeTtcclxuICB9XHJcblxyXG4gIGRyb3BJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuaW52ZW50b3J5LmRyb3BJdGVtKGl0ZW0pO1xyXG4gICAgcmV0dXJuIHRoaXMuaW52ZW50b3J5O1xyXG4gIH1cclxuXHJcbiAgZG9BY3Rpb24odGV4dCwgaXRlbSA9IG51bGwpIHtcclxuICAgIC8vIE5vIGl0ZW0gcGFzc2VkLCBjaGVjayByb29tIHByb21wdHMgZm9yIGFjdGlvbnNcclxuICAgIGlmIChpdGVtID09PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRSb29tLmRvQWN0aW9uKHRleHQpO1xyXG4gICAgfVxyXG4gICAgLy8gRG9pbmcgYWN0aW9uIG9uIGl0ZW0sIGNoZWNrIGl0ZW0gcHJvbXB0c1xyXG4gICAgcmV0dXJuIGl0ZW0uZG9BY3Rpb24odGV4dCk7XHJcbiAgfVxyXG59XHJcbiAgXHJcbiIsImltcG9ydCBQcm9tcHQgZnJvbSAnLi9wcm9tcHQnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUm9vbSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKG5hbWUgPSAnJywgZ2V0VGV4dCA9ICcnLCBwcm9tcHRzID0gW10sIHJlcXVpcmVtZW50cyA9IFtdKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5nZXRUZXh0ID0gZ2V0VGV4dDsgLy8gVGhlIHRleHQgdGhhdCBpcyBkaXNwbGF5ZWQgd2hlbiB0aGUgcm9vbSBpcyBlbnRlcmVkXHJcbiAgICB0aGlzLnByb21wdHMgPSBwcm9tcHRzOyAvLyBXaGF0IGFyZSB0aGUgYWN0aW9ucyB0aGF0IHdlIGNhbiBkbyBpbiB0aGlzIHJvb20/XHJcbiAgICB0aGlzLnJlcXVpcmVtZW50cyA9IHJlcXVpcmVtZW50czsgLy8gQW55IHJlcXVpcmVtZW50cyAoaXRlbXMpIG5lZWRlZCB0byBhY2Nlc3MgdGhlIHJvb21cclxuICB9XHJcblxyXG4gIGFkZFByb21wdChuYW1lLCBrZXl3b3JkcywgcmVzdWx0VGV4dHMpIHtcclxuICAgIGNvbnN0IHByb21wdCA9IG5ldyBQcm9tcHQobmFtZSwga2V5d29yZHMsIHJlc3VsdFRleHRzKTtcclxuICAgIHRoaXMucHJvbXB0cy5wdXNoKHByb21wdCk7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9tcHRzO1xyXG4gIH1cclxuXHJcbiAgZW50ZXIoaXRlbXMgPSBbXSkge1xyXG4gICAgbGV0IHJlc3VsdFRleHQgPSAnJztcclxuICAgIGxldCBtZXRBbGxSZXF1aXJlbWVudHMgPSB0cnVlOyAvLyBDYW4gd2UgZW50ZXIgdGhlIHJvb20/XHJcbiAgICAvLyBUaGUgcm9vbSBpcyBub3QgYWNjZXNzaWJsZSBieSBkZWZhdWx0XHJcbiAgICBpZiAodGhpcy5yZXF1aXJlbWVudHMgPiAwKSB7XHJcbiAgICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBtZXRBbGxSZXF1aXJlbWVudHMgPSBmYWxzZTtcclxuICAgICAgICAvLyBSZXR1cm4gbWlzc2luZyByZXF1aXJlbWVudCBtZXNzYWdlc1xyXG4gICAgICAgIHRoaXMucmVxdWlyZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKHJlcXVpcmVtZW50KSB7XHJcbiAgICAgICAgICByZXN1bHRUZXh0ICs9IGAke3JlcXVpcmVtZW50LmZhaWxUZXh0fS4gYDtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBDaGVjayB0aGUgcm9vbSdzIHJlcXVpcmVtZW50cyBmb3IgbWF0Y2hpbmcgaXRlbXNcclxuICAgICAgICB0aGlzLnJlcXVpcmVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChyZXF1aXJlbWVudCkge1xyXG4gICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0gPT09IHJlcXVpcmVtZW50KSB7XHJcbiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGlmIChmb3VuZCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgbWV0QWxsUmVxdWlyZW1lbnRzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIFJldHVybiBmYWlsIG1lc3NhZ2VzIGZvciBtaXNzaW5nIHJlcXVpcmVtZW50c1xyXG4gICAgICAgICAgICByZXN1bHRUZXh0ICs9IHJlcXVpcmVtZW50LmZhaWxUZXh0OyAgXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKG1ldEFsbFJlcXVpcmVtZW50cyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgcmVzdWx0VGV4dCA9IHRoaXMuZ2V0VGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc3VsdFRleHQgPSB0aGlzLmdldFRleHQ7XHJcbiAgICB9XHJcbiAgICAvLyBSZXR1cm4gdGV4dCB3aXRoIHJlc3VsdFRleHRzIGFuZCB3aGV0aGVyIG9yIG5vdCByb29tIGNvdWxkIGJlIGVudGVyZWRcclxuICAgIHJldHVybiBbcmVzdWx0VGV4dCwgbWV0QWxsUmVxdWlyZW1lbnRzXTtcclxuICB9XHJcblxyXG4gIGRvQWN0aW9uKHZhbHVlKSB7XHJcbiAgICAvLyBGb3Igbm93IGxldCdzIG9ubHkgZG8gb25lIGFjdGlvbiBhdCBhIHRpbWVcclxuICAgIGxldCByZXN1bHRUZXh0ID0ge307XHJcbiAgICBpZiAodGhpcy5wcm9tcHRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXN1bHRUZXh0Wyd0ZXh0J10gPSBcIlRoZXJlIGRvZXNuJ3Qgc2VlbSB0byBiZSBhbnkgYWN0aW9ucyB5b3UgY2FuIGRvIGluIHRoaXMgcm9vbS5cIjtcclxuICAgIH1cclxuICAgIE9iamVjdC52YWx1ZXModGhpcy5wcm9tcHRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSwgdmFsKSB7IFxyXG4gICAgICBpZiAodmFsdWUgPT09IGtleSkge1xyXG4gICAgICAgIHJlc3VsdFRleHRbJ3RleHQnXSA9IHZhbC5yZXN1bHRUZXh0VGV4dDsgLy8gU3VjY2Vzc2Z1bCBhY3Rpb24gcmV0dXJuaW5nIHJlc3VsdFRleHRpbmcgdGV4dFxyXG4gICAgICAgIGlmICh2YWwucmVzdWx0VGV4dEl0ZW1zICE9PSBudWxsKSB7XHJcbiAgICAgICAgICByZXN1bHRUZXh0WydpdGVtcyddID0gdmFsLnJlc3VsdFRleHRJdGVtczsgLy8gU3VjY2Vzc2Z1bCBhY3Rpb24gcmVzdWx0VGV4dGluZyBpbiBuZXcgaXRlbXNcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZhbC5yZXN1bHRUZXh0Um9vbSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgcmVzdWx0VGV4dFsncmVzdWx0VGV4dCddID0gdmFsLnJlc3VsdFRleHRSb29tOyAvLyBTdWNjZXNzZnVsIGFjdGlvbiByZXN1bHRUZXh0aW5nIGluIGEgbmV3IHJvb21cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHJlc3VsdFRleHQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb21wdCB7XHJcbiAgIFxyXG4gIGNvbnN0cnVjdG9yKG5hbWUgPSAnJywga2V5d29yZHMgPSBbXSwgcmVzdWx0cyA9IHt9LCByZXF1aXJlbWVudHMgPSBbXSkge1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIC8vIEtleXdvcmRzIHRoYXQgY2FuIHRyaWdnZXIgdGhlIHByb21wdCAobWFrZSBhbGwgbG93ZXItY2FzZSBieSBkZWZhdWx0KVxyXG4gICAgdGhpcy5rZXl3b3JkcyA9IGtleXdvcmRzLm1hcChmdW5jdGlvbih2KSB7IHJldHVybiB2LnRvTG93ZXJDYXNlKCk7fSk7IFxyXG4gICAgLy8gUmVzdWx0cyB0aGF0IG9jY3VyIHdoZW4gdGhpcyBwcm9tcHQgaXMgc3VjY2Vzc2Z1bGx5IHRyaWdnZXJlZDsgXHJcbiAgICAvLyB0aGUgcmVzdWx0IGtleXMgY29tcHJpc2Ugb2Yg4oCcc3VjY2Vzc1RleHTigJ0gKHJlcXVpcmVkKSwgXCJmYWlsVGV4dFwiIChvcHRpb25hbCksXHJcbiAgICAvLyDigJxpdGVtc1JlcXVpcmVk4oCdIChvcHRpb25hbCksIC8vIGFuZCDigJxyb29tVG9FbnRlclwi4oCdIFxyXG4gICAgdGhpcy5yZXN1bHRzID0gcmVzdWx0czsgXHJcbiAgICAvLyBBbnkgcHJlLXJlcXVpc3RpZSBpdGVtcyBuZWVkZWQgdG8gZG8gdGhlIHByb21wdD9cclxuICAgIHRoaXMucmVxdWlyZW1lbnRzID0gcmVxdWlyZW1lbnRzOyBcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIGlucHV0IG1lc3NhZ2UgbWF0Y2hlcyBhbnkgcHJvbXB0IGtleXdvcmRzXHJcbiAgbWF0Y2hLZXl3b3JkcyhtZXNzYWdlLCBpdGVtcyA9IFtdKSB7XHJcbiAgICBsZXQgZm91bmRLZXl3b3JkID0gZmFsc2U7XHJcbiAgICBpZiAodGhpcy5yZXF1aXJlbWVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBsZXQgbWlzc2luZ1JlcXVpcmVtZW50cyA9IFtdO1xyXG4gICAgICB0aGlzLnJlcXVpcmVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcXVpcmVtZW50KSB7XHJcbiAgICAgICAgbGV0IGZvdW5kUmVxdWlyZW1lbnQgPSBmYWxzZTtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgIGlmIChpdGVtID09PSByZXF1aXJlbWVudCkge1xyXG4gICAgICAgICAgICBmb3VuZFJlcXVpcmVtZW50ID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoIWZvdW5kUmVxdWlyZW1lbnQpIHtcclxuICAgICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaChyZXF1aXJlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKG1pc3NpbmdSZXF1aXJlbWVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiB7J2ZhaWwnOiBtaXNzaW5nUmVxdWlyZW1lbnRzfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5rZXl3b3Jkcy5mb3JFYWNoKGZ1bmN0aW9uKGtleXdvcmQpIHtcclxuICAgICAgaWYgKG1lc3NhZ2UuaW5jbHVkZXMoa2V5d29yZC50b0xvd2VyQ2FzZSgpKSkge1xyXG4gICAgICAgIGZvdW5kS2V5d29yZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgaWYgKGZvdW5kS2V5d29yZCkge1xyXG4gICAgICByZXR1cm4geydzdWNjZXNzJzogdGhpcy5yZXN1bHRzfTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBJdGVtIHtcclxuICAgXHJcbiAgY29uc3RydWN0b3IobmFtZSA9ICcnLCBnZXRUZXh0ID0gJycpIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLmdldFRleHQgPSBnZXRUZXh0OyAvLyBUZXh0IGRpc3BsYXllZCB3aGVuIGl0ZW0gaXMgZ290dGVuXHJcbiAgfVxyXG5cclxuICBnZXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRUZXh0O1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9